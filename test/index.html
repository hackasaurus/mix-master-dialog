<!DOCTYPE html>
<meta charset="utf-8">
<title>Mix Master Dialog Unit Tests</title>
<link rel="stylesheet" href="qunit.css">

<script src="../jquery.min.js"></script>
<script src="../protovis-r3.2.js"></script>
<script src="../ace/ace.js"></script>
<script src="../ace/mode-html.js"></script>
<script src="../ace/theme-eclipse.js"></script>
<script src="../webxray/src/utils.js"></script>
<script src="../webxray/src/tag-colors.js"></script>
<script src="../webxray/src/event-emitter.js"></script>
<script src="../webxray/src/focused-overlay.js"></script>
<script src="../webxray/src/hud-overlay.js"></script>
<script src="../mix-master-dialog.js"></script>

<script src="qunit.js"></script>

<!-- This is for TestSwarm only. -->
<script src="/js/inject.js"></script>

<script>
module("mix-master-dialog");

test("setupEditor triggers onChange on init", function() {
  var wasCalled = false;
  var textContent = "Monkeys are cool!";
  var editorObj = jQuery.setupEditor("test-editor-div", textContent, 
    function onChange(t) {
      equals(t, textContent, 
             "onChange must receive initial contents");
      wasCalled = true;
    });

  ok(wasCalled, "onChange handler must be triggered");
  editorObj.destroy();
});

test("setupEditor initializes default content", function() {
  var textContent = "Sheep are cool!";
  var editorObj = jQuery.setupEditor("test-editor-div", textContent,
                                      function onChange() {
                                     });
  equals(editorObj.getText(), textContent);
  editorObj.destroy();
});

test("setupUI renders changes in editor to HTML", function () {
  var rendering = $("#test-rendering");
  var startHTML = "<p>this is <em>html</em>.</p>";
  var ui = jQuery.setupUI({
    rendering: rendering,
    skeleton: $("#test-skeleton"),
    defaultHudContent: "boop",
    defaultEditorContent: startHTML,
    idToEdit: "test-editor-div"
  });
  equals(rendering.html(), startHTML);
  ui.destroy();
});

</script>

<h1 id="qunit-header">Mix Master Dialog Unit Tests</h1>
<h2 id="qunit-banner"></h2>
<div id="qunit-testrunner-toolbar"></div>
<h2 id="qunit-userAgent"></h2>
<ol id="qunit-tests"></ol>
<div id="qunit-fixture">
  <div id="test-editor-div"></div>
  <div id="test-rendering"></div>
  <div id="test-skeleton"></div>  
</div>
